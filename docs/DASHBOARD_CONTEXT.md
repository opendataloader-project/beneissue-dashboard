# Beneissue 메트릭 대시보드 구현 계획

## 개요

AI 이슈 자동화 성능을 측정하고 시각화하는 웹 대시보드

**목적:**
- 투자자/파트너에게 AI 자동화 성과 증명
- 팩트 기반 지표로 신뢰성 확보
- 내부 성능 모니터링

**URL:** `beneissue.opendataloader.org`

---

## 아키텍처

```
[GitHub Actions]
       │
       ▼
[beneissue Python] ──POST──▶ [Supabase PostgreSQL]
                                      │
                              ◀──SELECT──
                                      │
                              [Next.js + Vercel]
                              (API Routes = 비즈니스 로직)
                                      │
                                      ▼
                        beneissue.opendataloader.org
```

**핵심 설계:**
- Python → Supabase 직접 쓰기 (service_key)
- Next.js → Supabase 읽기 전용 (anon_key)
- 별도 백엔드 서버 불필요 (서버리스)

---

## 배포 구조

| 레포 | 도메인 | 역할 |
|------|--------|------|
| `opendataloader/beneissue` | - | Python CLI, 메트릭 수집 |
| `opendataloader/beneissue-dashboard` | beneissue.opendataloader.org | 대시보드 UI |

---

## 기술 스택

| 항목 | 선택 |
|------|------|
| 프론트엔드 | Next.js 15 + shadcn/ui + Recharts |
| DB | Supabase PostgreSQL |
| 호스팅 | Vercel (무료) |
| 인증 | API Key (로그인 불필요) |

**무료 한도:**
- Vercel: 100GB/월 대역폭
- Supabase: 500MB DB, 50K 요청/월

---

## 대시보드 페이지

| 경로 | 인증 | 용도 |
|------|------|------|
| `/` | 없음 | Public Stats (간략한 집계 지표) |
| `/dashboard` | API Key | 통합 대시보드 (팩트 기반 지표) |

---

## 메트릭 정의 (팩트 기반)

### 핵심 지표 (100% 실측)

| 지표 | 계산 | 설명 |
|------|------|------|
| 총 처리량 | `count(*)` | 처리된 이슈 수 |
| 자동 해결율 | `auto_resolved / total × 100` | 인간 개입 없이 종료 % |
| 평균 응답 시간 | `avg(first_response - issue_created)` | 첫 응답까지 시간 |
| 총 AI 비용 | `sum(cost_usd)` | 실제 API 비용 |
| 건당 AI 비용 | `sum(cost_usd) / count(*)` | 이슈당 평균 비용 |

### 자동 해결 케이스

인간 개입 없이 종료 가능한 케이스:
- `triage/invalid` - 유효하지 않은 이슈
- `triage/duplicate` - 중복 이슈
- `triage/needs-info` - 정보 요청 후 대기
- `fix/completed` - PR 자동 생성 완료
- `fix/comment-only` - 코멘트로 해결 (코드 변경 불필요)

---

## 기간 필터

| 옵션 | 설명 |
|------|------|
| 오늘 | 당일 데이터 |
| 이번 주 | 현재 주 데이터 |
| 이번 달 | 현재 월 데이터 (기본값) |
| 최근 30일 | 최근 30일간 데이터 |
| 사용자 지정 | 날짜 범위 직접 선택 |

---

## 와이어프레임

### Public Stats (/)
```
┌─────────────────────────────────────────────────────┐
│  Beneissue - AI Issue Automation                    │
├─────────────────────────────────────────────────────┤
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌────────┐ │
│  │  1,247   │ │   32%    │ │   45초   │ │ $15.80 │ │
│  │ 총 처리량 │ │ 자동해결율│ │ 평균응답  │ │ AI비용  │ │
│  └──────────┘ └──────────┘ └──────────┘ └────────┘ │
│  [────────────────────────] 월별 추이               │
└─────────────────────────────────────────────────────┘
```

### Dashboard (/dashboard)
```
┌─────────────────────────────────────────────────────────────┐
│  Beneissue Dashboard                     [이번 달 ▾]        │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌────────────────┐ │
│  │  1,247   │ │   32%    │ │   45초   │ │  $15.80        │ │
│  │ 총 처리량 │ │ 자동해결율│ │ 평균응답  │ │ 총 AI비용      │ │
│  │ ▲+31%   │ │ ▲+5%    │ │ ▼-12%   │ │ (건당 $0.013)  │ │
│  └──────────┘ └──────────┘ └──────────┘ └────────────────┘ │
│                                                             │
│  ┌─────────────────────────┐ ┌───────────────────────────┐ │
│  │ 일별 추이               │ │ 처리 결과 분포            │ │
│  │ [라인 차트]             │ │ [파이 차트]               │ │
│  └─────────────────────────┘ └───────────────────────────┘ │
│                                                             │
│  ┌─────────────────────────────────────────────────────────┐│
│  │ 단계별 처리 시간                                         ││
│  │ Triage: 12s  │  Analyze: 45s  │  Fix: 3m 20s           ││
│  └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

---

## 설계 원칙

1. **팩트 기반**: 모든 지표는 100% 실측 데이터
2. **추정치 제외**: ROI, 시간절감, 비용절감 등 근거 없는 추정치 제거
3. **단일 대시보드**: Executive/Operations 분리 없이 통합
4. **기간 필터**: 유연한 기간 선택으로 다양한 분석 지원

---

## Phase 2 (향후)

- `@beneissue wrong` - AI 판단 오류 피드백 수집
- 정확도 지표 = correct / (correct + wrong)
- 피드백 기반 AI 개선 루프
